<source>
  @type forward
  @id forward_input
  port  24224
</source>


<match **.**>
 @type copy
 <store>
type s3
s3_bucket "#{ENV['FLUENTD_S3_BUCKET']}"
s3_region "#{ENV['FLUENTD_S3_REGION']}"
s3_object_key_format %{path}%{hostname}%{time_slice}_%{index}.%{file_extension}
path logs/
buffer_path /var/tmp/s3
time_slice_format -%Y-%m-%d-%H
time_slice_wait 5m
utc
store_as json
buffer_chunk_limit 256m
format_json true
include_time_key true
include_tag_key true
</store>
<store>
@type elasticsearch
logstash_format true
host elasticsearch
port 9200
index_name: fluentd
type_name: fluentd
include_tag_key true
buffer_type memory
flush_interval 5
retry_limit 17
retry_wait 1.0
num_threads 1
</store>
</match>
